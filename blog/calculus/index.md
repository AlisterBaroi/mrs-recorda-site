---
title: '数学：微积分'
date: 2024-02-17T12:00
authors: [lailai]
tags: [math]
---

<!-- truncate -->

## 参考资料

- [积分 - 维基百科](https://zh.wikipedia.org/zh-cn/积分)

## 前缀和

:::tip

前缀和对于接触过算法竞赛（OI 或 ICPC）的读者应该并不陌生。

:::

思考：有一个 **固定** 的数列 $\{A_1,A_2,\cdots,A_n\}$，需要 **频繁** 计算某个区间 $[a,b]$ 上的总和 $T$，如何实现高效计算？

$$
T=\sum_{i=a}^b A_i=A_a+A_{a+1}+\cdots+A_b
$$

如果每次都从 $A_a$ 累加到 $A_b$，需要相加很多数，效率较低。

由于数列是固定的，我们可以进行 **前缀和** 的预处理，提前计算出 **前缀和数列** $S_n$：

$$
S_k=\sum_{i=1}^k A_i=A_1+A_2+\cdots+A_k
$$

这样，$S_k$ 就表示数列 $\{A_n\}$ 前 $k$ 项的和。

:::tip[预处理]

预处理是指在正式计算之前，提前把一些可能 **重复** 用到的计算结果算好、存好。

这样之后计算就能更高效，不必重复做相同的事。**前缀和** 就是一种经典的预处理技巧。

:::

利用前缀和，就可以高效计算任意区间 $[a,b]$ 的和：

$$
\begin{aligned}
  T &= \sum_{i=a}^b A_i=A_a+A_{a+1}+\cdots+A_b \\
  &= (\bcancel{A_1+A_2+\cdots+A_{a-1}}+A_a+A_{a+1}+\cdots+A_b)-(\bcancel{A_1+A_2+\cdots+A_{a-1}}) \\
  &= \sum_{i=1}^b A_i-\sum_{i=1}^{a-1} A_i=S_b-S_{a-1}
\end{aligned}
$$

因此，通过预处理数列 $\{A_n\}$ 得到前缀和数列 $\{S_n\}$，可以高效区间求和：

$$
T=\sum_{i=a}^b=S_b-S_{a-1}
$$

## 定积分

:::tip

为便于理解，本文所指函数均为常见的连续函数。

:::

一些简单的图形，比如 **长方形**，当我们已知边长为 $a$ 和 $b$ 时，可以使用 **乘法** 这个工具来计算其面积：

$$
S=a\times b
$$

对于更复杂的图形，比如边界是 **曲线** 的图形，就需要更高级的面积计算工具——**定积分**。

$$
S=\int_a^b f(x)\mathrm{d}x
$$

其中 $\displaystyle\int$ 称为 **积分号**，$a$ 称为 **积分下界**，$b$ 称为 **积分上界**，$f(x)$ 称为 **被积函数**。

简单来说，定积分 $\displaystyle\int_a^b f(x)\mathrm{d}x$ 表示函数 $f(x)$ 图像在区间 $[a,b]$ 上与 $x$ 轴所围成的 **有向面积**：

$$
S=\int_a^b f(x)\mathrm{d}x=|S_\text{蓝色}|-|S_\text{黄色}|
$$

![](assets/Integral_example.svg-1024722.png)

我们平时理解的“面积”通常是正数，但在数学中，面积也可以为负。

在计算定积分时，我们约定：图像在 $x$ 轴 **上方** 的区域（蓝色）面积为 **正**，**下方** 的区域（黄色）面积为 **负**，这种带符号的面积叫作 **有向面积**。

:::tip[带符号的意义]

这种表示方式在数学、科学，甚至生活中都很常见。

很多看似“只有大小”的量，其实也可以有正负之分，用来表示方向或性质。例如角度、面积、长度、位移、海拔、温度、记账等。

这样有一个明显的好处：可以直接代入公式，自动处理方向，简化计算与判断。

<Tabs>
<TabItem value="海拔">

一个人从海拔 $0$ 米出发，连续经过以下高度变化：

上升 $300$ 米；下降 $120$ 米；上升 $50$ 米；下降 $80$ 米；下降 $100$ 米；上升 $60$ 米。

如果不用正负号，每一步都要先判断方向，再决定加减，过程繁琐。

但如果用正负数来表示（上升为正，下降为负），变成：

$$
(+300)+(-120)+(+50)+(-80)+(-100)+(+60)=110
$$

这样，只需把这些数值直接相加，就能快速算出最终高度。

</TabItem>
<TabItem value="记账">

一个人从余额 $0$ 元开始，连续经过以下收支变化：

收入 $300$ 元；支出 $120$ 元；收入 $50$ 元；支出 $80$ 元；支出 $100$ 元；收入 $60$ 元。

如果不用正负号，每一步都要先判断性质，再决定加减，过程繁琐。

但如果用正负数来表示（收入为正，支出为负），变成：

$$
(+300)+(-120)+(+50)+(-80)+(-100)+(+60)=110
$$

这样，只需把这些数值直接相加，就能快速算出最终余额。

</TabItem>
<TabItem value="角度">

一个机器人从正前方（$0^\circ$）开始，连续经过以下旋转变化：

左转 $300^\circ$；右转 $120^\circ$；左转 $50^\circ$；右转 $80^\circ$；右转 $100^\circ$；左转 $60^\circ$。

如果不用正负号，每次都要先判断方向，再决定加减，过程繁琐。

但如果用正负角度表示（左转为正，右转为负），变成：

$$
(+300)+(-120)+(+50)+(-80)+(-100)+(+60)=110
$$

这样，只需把这些角度直接相加，就能快速算出最终方向。

</TabItem>
</Tabs>

:::

## 数列与函数

数列可以看作以正整数为定义域的函数。

数列是离散的函数，函数的连续的数列。

| 对比 |             数列（离散）              |               函数（连续）               |
| :--: | :-----------------------------------: | :--------------------------------------: |
| 原本 |               $A_n$                  |                $f(x)$                   |
| 计算从 $a$ 到 $b$ 的“和” | $\displaystyle\sum_{i=a}^b A_i$       | $\displaystyle\int_a^b f(x)\mathrm{d}x$ |
| 方法 |              前缀和                  |              不定积分                   |
| 结果 |         前缀和数列 $S_n$             |            原函数 $F(x)$                |

## 不定积分

定积分的定义并不复杂，但我们更关心的是如何计算它。

$$
\int_a^b f(x)\mathrm{d}x
$$

前面我们已经通过对 **数列** $\{A_n\}$ 做 **前缀和**，得到了 **前缀和数列** $\{S_n\}$，从而高效区间求和：

$$
S_n=\sum_{i=1}^n A_i
$$

$$
\underbrace{\{A_n\}}_{\text{数列}}
\xrightarrow{\text{前缀和}}
\underbrace{\{S_n\}}_{\text{前缀和数列}}
$$

类似地，**不定积分** 就像是对 **函数** $f(x)$ 做“前缀和”，得到的结果就是 **原函数** $F(x)$：

$$
F(x)=\int f(x)\mathrm{d}x
$$

$$
\underbrace{f(x)}_{\text{函数}}
\xrightarrow{\text{不定积分}}
\underbrace{F(x)}_{\text{原函数}}
$$

原函数 $F(k)$ 可以理解为函数 $f(x)$ 在区间 $[c,k]$ 的面积（定积分），其中 $c$ 是一个 **任意** 的常数。

$$
F(x)=\int_c^k f(x)\mathrm{d}x
$$

这里就体现了使用有向面积的好处：我们无需考虑 $k$ 和 $c$ 的关系，即使 $k<c$ 也可以直接代入公式。

$$
\int_c^k f(x)\mathrm{d}x=-\int_k^c f(x)\mathrm{d}x
$$

## 牛顿-莱布尼茨公式

同理，利用原函数，就可以计算 $f(x)$ 在区间 $[a,b]$ 的面积 $S$：

$$
\begin{aligned}
  S &= \int_a^b f(x)\mathrm{d}x \\
  &= \int_c^b f(x)\mathrm{d}x-\int_c^a f(x)\mathrm{d}x \\
  &= F(b)-F(a)=\left.F(x)\right|_a^b
\end{aligned}
$$

其中 $F(b)-F(a)$ 也可以用 **竖线求值符号** $\left.F(x)\right|_a^b$ 表示。

至此，我们得到了微积分学中最重要的公式——**牛顿-莱布尼茨公式**。

$$
\int_a^b f(x)\mathrm{d}x=F(b)-F(a)=\left.F(x)\right|_a^b
$$

<!-- ![](assets/400px-Integral_approximations-3-steps.png) -->

## 微积分基本定理

**微积分基本定理** 是微积分学中的一条重要定理，由 [艾萨克·牛顿](https://zh.wikipedia.org/zh-cn/艾萨克·牛顿) 和 [戈特弗里德·莱布尼茨](https://zh.wikipedia.org/zh-cn/戈特弗里德·莱布尼茨) 在十七世纪分别独立发现，描述了微积分的两个主要运算——**微分** 和 **积分** 之间的关系。

该定理分为两个部分，分别为 **微积分第一基本定理** 和 **微积分第二基本定理**，后者也被称为 **牛顿-莱布尼茨公式**。

## 原函数

刚才我们通过模仿数列的前缀和，推导出了计算定积分的方法：求出原函数并做差。

思考：如何计算函数 $f(x)$ 的原函数 $F(x)$ 呢？
